name: Discussion Management
on:
  discussion:
    types: [created, edited]

permissions:
  discussions: write
  issues: write

jobs:
  triage:
    runs-on: ubuntu-latest
    steps:
      - name: Handle new discussion
        uses: actions/github-script@v6
        with:
          script: |
            const { data: repo } = await github.rest.repos.get({
              owner: context.repo.owner,
              repo: context.repo.repo
            });
            
            if (context.payload.discussion.category.slug === 'ideas') {
              github.rest.reactions.createForDiscussionComment({
                owner: context.repo.owner,
                repo: context.repo.repo,
                discussion_number: context.payload.discussion.number,
                content: 'rocket'
              });
              
              github.rest.issues.createComment({
                owner: context.repo.owner,
                repo: context.repo.repo,
                issue_number: context.payload.discussion.number,
                body: `ğŸš€ æ„Ÿè°¢æ‚¨çš„å»ºè®®ï¼æˆ‘ä»¬å·²ç»å°†å…¶æ ‡è®°ä¸º [${repo.topics.join(' ')}] ç›¸å…³ææ¡ˆã€‚`
              });
            }
